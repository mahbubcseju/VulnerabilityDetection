import os
import subprocess

dataset = "MSR"

if dataset == "Devign":

    base_path = "/work/LAS/weile-lab/mdrahman/SliceLevelVulnerabilityDetection/data/Devign/program_data"
    for folder in os.listdir(base_path):
        if os.path.isfile(os.path.join(base_path, folder)):
            continue
        next_path = os.path.join(base_path, folder)
        os.chdir(next_path)
        subprocess.call(["java", "-Xmx16g", "-jar", "/work/LAS/weile-lab/mdrahman/SliceLevelVulnerabilityDetection/joern-0.3.1/bin/joern.jar", folder])
    print("Success")

else:
    base_path = "/work/LAS/weile-lab/mdrahman/SliceLevelVulnerabilityDetection/data/MSR/program_data"
    for folder in os.listdir(base_path):
        if os.path.isfile(os.path.join(base_path, folder)) or 'data' not in folder:
            continue
        next_path = os.path.join(base_path, folder)
        os.chdir(next_path)
        subprocess.call(["java", "-Xmx16g", "-jar", "/work/LAS/weile-lab/mdrahman/SliceLevelVulnerabilityDetection/joern-0.3.1/bin/joern.jar", folder])
    print("Success")
